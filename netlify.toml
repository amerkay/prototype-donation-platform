[build]
  command = "pnpm build"
  publish = "dist"

[functions]
  # Use esbuild bundler - required for native modules
  node_bundler = "esbuild"
  # Don't bundle these - native binaries or ESM compatibility issues
  external_node_modules = ["@sparticuz/chromium", "puppeteer-core", "jsdom", "isomorphic-dompurify"]

[build.environment]
  # Skip downloading Chromium during build (using @sparticuz/chromium instead)
  PUPPETEER_SKIP_CHROMIUM_DOWNLOAD = "true"
